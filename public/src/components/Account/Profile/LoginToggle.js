import React, {Component} from "react";

const SocialLoginToggle = ({
	onlyOneLeft,
	isEnabled,
	signInMethod,
	onLink,
	onUnlink
}) =>
	isEnabled ? (
		<button
			type="button"
			onClick={() => onUnlink(signInMethod.id)}
			disabled={onlyOneLeft}
		>
			Deactivate {signInMethod.id}
		</button>
	) : (
		<button type="button" onClick={() => onLink(signInMethod.provider)}>
			Link {signInMethod.id}
		</button>
	);

class DefaultLoginToggle extends Component {
	constructor(props) {
		super(props);

		this.state = {passwordOne: "", passwordTwo: ""};
	}

	onSubmit = event => {
		event.preventDefault();

		this.props.onLink(this.state.passwordOne);
		this.setState({passwordOne: "", passwordTwo: ""});
	};

	onChange = event => {
		this.setState({[event.target.name]: event.target.value});
	};

	render() {
		const {onlyOneLeft, isEnabled, signInMethod, onUnlink} = this.props;

		const {passwordOne, passwordTwo} = this.state;

		const isInvalid = passwordOne !== passwordTwo || passwordOne === "";

		return isEnabled ? (
			<button
				type="button"
				onClick={() => onUnlink(signInMethod.id)}
				disabled={onlyOneLeft}
			>
				Deactivate {signInMethod.id}
			</button>
		) : (
			<form onSubmit={this.onSubmit}>
				<input
					name="passwordOne"
					value={passwordOne}
					onChange={this.onChange}
					type="password"
					placeholder="New Password"
				/>
				<input
					name="passwordTwo"
					value={passwordTwo}
					onChange={this.onChange}
					type="password"
					placeholder="Confirm New Password"
				/>

				<button disabled={isInvalid} type="submit">
					Link {signInMethod.id}
				</button>
			</form>
		);
	}
}

export {DefaultLoginToggle, SocialLoginToggle};
